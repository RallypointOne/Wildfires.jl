---
title: Benchmarks
engine: julia
---

```{julia}
#| echo: false
#| output: asis
import JSON3

json = try
    read(pipeline(`git show origin/benchmark-results:results.json`, stderr=devnull), String)
catch
    nothing
end

if isnothing(json)
    println("::: {.callout-note}")
    println("## No benchmark results available")
    println()
    println("Benchmarks have not been set up for this package yet.  See the CLAUDE.md for instructions on how to set up benchmarks.")
    println(":::")
else
    data = JSON3.read(json)

    println("| **Julia Version** | $(data.julia_version) |")
    println("|:--|:--|")
    println("| **CPU** | $(data.cpu) |")
    println("| **Timestamp** | $(data.timestamp) |")
    println()

    # Helper to format time
    function fmt_time(ns)
        if ns < 1_000
            "$(round(ns, digits=1)) ns"
        elseif ns < 1_000_000
            "$(round(ns / 1_000, digits=2)) Î¼s"
        elseif ns < 1_000_000_000
            "$(round(ns / 1_000_000, digits=2)) ms"
        else
            "$(round(ns / 1_000_000_000, digits=2)) s"
        end
    end

    # Helper to format memory
    function fmt_mem(bytes)
        if bytes < 1024
            "$bytes B"
        elseif bytes < 1024^2
            "$(round(bytes / 1024, digits=1)) KiB"
        elseif bytes < 1024^3
            "$(round(bytes / 1024^2, digits=1)) MiB"
        else
            "$(round(bytes / 1024^3, digits=1)) GiB"
        end
    end

    println("| Benchmark | Median Time | Memory | Allocations |")
    println("|:----------|:------------|:-------|:------------|")
    for b in data.benchmarks
        println("| `$(b.name)` | $(fmt_time(b.time_ns)) | $(fmt_mem(b.memory_bytes)) | $(b.allocs) |")
    end
end
```
